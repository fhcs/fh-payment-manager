# ПСКБ
https://docs.pscb.ru/oos/index.html

### config\payment.php

```php
return [
    'system' => env('PAYMENT_SYSTEM', 'pscb'),
    
    /*
     * Настройки для ПСКБ
     * https://docs.pscb.ru/oos/index.html
     */
    'pscb' => [
        /*
         * ID магазина (обязательно)
         * использовать значение из Кабинета мерчанта
         */
        'marketPlace' => env('PSCB_MERCHANT_ID', ''),

        /*
         * Ключ API (обязательно)
         * использовать значение из Кабинета мерчанта
         */
        'secretKey' => env('PSCB_MERCHANT_KEY', '111111'),

        /*
         * Адрес запроса плетежей
         * для тестирования используйте https://oosdemo.pscb.ru/pay/
         */
        'requestUrl' => env('PSCB_REQUEST_URL', 'https://oosdemo.pscb.ru/pay/'),

        /*
         * Адрес запроса для дополнительных возможностей
         * Адрес запроса зависит от вызываемого метода API.
         * для тестирования используйте https://oos.pscb.ru/merchantApi/
         */
        'merchantApiUrl' => env('PSCB_MERCHANT_API_URL', 'https://oosdemo.pscb.ru/merchantApi/'),

        /*
         * Адрес возврата в случае успешной оплаты
         * покупатель будет перенаправлен по нему после успешной оплаты
         * если адреса отсутствуют в запросе, они берутся из соответствующих настроек Кабинета мерчанта
         * если адреса не указаны и в Кабинете, плательщик останется на странице успеха/неуспеха на стороне Банка
         */
        'successUrl' => env('PSCB_SUCCESS_URL', ''),

        /*
         * Адрес возврата в случае неуспешной оплаты
         * покупатель будет перенаправлен по нему после неуспешной оплаты
         * если адреса отсутствуют в запросе, они берутся из соответствующих настроек Кабинета мерчанта
         * если адреса не указаны и в Кабинете, плательщик останется на странице успеха/неуспеха на стороне Банка
         */
        'failUrl' => env('PSCB_FAIL_URL', ''),

        /*
         * Язык платёжных страниц
         * допустимые значения параметра:
         * '' - язык выберется автоматически
         * 'RU' - русский (по умолчанию)
         * 'EN' - английский.
         */
        'displayLanguage' => env('PSCB_DISPLAY_LANGUAGE', 'RU')
    ]
    
    ...
]
```

### .env
Обязательные параметры:
```dotenv
# ID магазина, использовать значение из Кабинета мерчанта
PSCB_MERCHANT_ID=123456789

#Ключ API, спользовать значение из Кабинета мерчанта
PSCB_MERCHANT_KEY=111111
```

Необязательные параметры:

```dotenv
# Адрес запроса плетежей
# по умолчанию https://oosdemo.pscb.ru/pay/
PSCB_REQUEST_URL=https://oos.pscb.ru/pay/

# Адрес запроса для дополнительных возможностей
# Адрес запроса зависит от вызываемого метода API.
# по умолчанию https://oosdemo.pscb.ru/merchantApi/
PSCB_MERCHANT_API_URL=https://oos.pscb.ru/merchantApi/

# Адрес возврата в случае успешной оплаты
# покупатель будет перенаправлен по нему после успешной оплаты
# если адреса отсутствуют в запросе, они берутся из соответствующих настроек Кабинета мерчанта
# если адреса не указаны и в Кабинете, плательщик останется на странице успеха/неуспеха на
# стороне Банка       
PSCB_SUCCESS_URL=https://youmarket.com/success

# Адрес возврата в случае неуспешной оплаты
# покупатель будет перенаправлен по нему после неуспешной оплаты
# если адреса отсутствуют в запросе, они берутся из соответствующих настроек Кабинета мерчанта
# если адреса не указаны и в Кабинете, плательщик останется на странице успеха/неуспеха на
# стороне Банка       
PSCB_FAIL_URL=https://youmarket.com/fail

# Язык платёжных страниц
# допустимые значения параметра:
# '' - язык выберется автоматически
# 'RU' - русский (по умолчанию)
# 'EN' - английский.
PSCB_DISPLAY_LANGUAGE=RU
```

### Запрос (QueryBuilder)

См. [PscbQueryBuilder](PscbQueryBuilder.php)

### Обработчик запросов (RequestHandler)

Создать запрос:
```php
$requestHandler = RequestHandler::create('checkPayment', ['orderId' => 'TEST_123']);
```

Отправить запрос и получить ответ:
```php
$response = $requestHandler->send();
```

Создать запрос для определенной платежной системы:
```php
$requestHandler = RequestHandler::paymentSystem('pscb')
                        ->create('checkPayment', ['orderId' => 'TEST_123']);
```
